<div class="container" data-ng-cloak data-ng-controller="ViewSettingsCtrl">
<h2>{{ 'View Settings' | translate }}</h2>
<form name="viewSettingForm" novalidate>
<button class="btn btn-primary {{interfaceConfig.pullToSide}}" data-ng-click="settingsApply()"  
	data-ng-disabled="viewSettingForm.$pristine || !allRolesHaveAtLeastOneSense()">
	<i class="icon-ok"></i> {{'Apply' | translate}}</button>
<tabset>
	<tab data-ng-repeat="roleTab in roleTabs" class="{{interfaceConfig.pullNormal}}" active="roleTab.active">
		<tab-heading>{{roleTab.name | translate}}
			<span data-ng-hide="isAtLeastOneSense(roleTab.view)">
				<img src="/images/shared/exclamation.png" title="{{'At least one Sense field must be enabled!' | translate}}" style="padding-left: 5px;"/></span>
		</tab-heading>
		<div class="row outer-flex">
		
		<!-- Left column: field view settings -->
		<div class="span3 control-group">
			<h3 translate="Fields"></h3>
			
			<!-- control buttons -->
			<div class="control-group">
				<label class="checkbox"><input type="checkbox" data-ng-click="showAllFields = ! showAllFields">
					{{'Show All Fields' | translate}}</label>
			</div>
			
			<!-- select list -->
			<dl class="picklists" style="height: 200px; overflow-y: auto;">
				<dt translate="Entry Level Fields"></dt>
				<dd><div class="controls">
					<div data-ng-repeat="fieldName in configDirty.entry.fieldOrder"
						data-ng-class="{selected:currentField.name == fieldName}">
						<span data-ng-hide="fieldIsHidden(fieldName, showAllFields)"
							data-ng-style="{'font-style': fieldIsCustom(fieldName) ? 'italic' : 'normal'}"
							data-ng-click="selectField(fieldName)">
							{{fieldConfig[fieldName].label}}</span>
					</div>
				</div></dd>
				<dt>{{'Sense Level Fields' | translate}} 
					<span data-ng-hide="isAtLeastOneSense(roleTab.view)">
					<img src="/images/shared/exclamation.png" title="{{'At least one Sense field must be enabled!' | translate}}" style="position: absolute; padding-left: 5px;"/></span></dt>
				<dd><div class="controls">
					<div data-ng-repeat="fieldName in configDirty.entry.fields.senses.fieldOrder"
						data-ng-class="{selected:currentField.name == fieldName}">
						<span data-ng-hide="fieldIsHidden(fieldName, showAllFields)"
							data-ng-style="{'font-style': fieldIsCustom(fieldName) ? 'italic' : 'normal'}"
							data-ng-click="selectField(fieldName)">
							{{fieldConfig[fieldName].label}}</span>
					</div>
				</div></dd>
				<dt translate="Example Level Fields"></dt>
				<dd><div class="controls">
					<div data-ng-repeat="fieldName in configDirty.entry.fields.senses.fields.examples.fieldOrder"
						data-ng-class="{selected:currentField.name == fieldName}">
						<span data-ng-hide="fieldIsHidden(fieldName, showAllFields)"
							data-ng-style="{'font-style': fieldIsCustom(fieldName) ? 'italic' : 'normal'}"
							data-ng-click="selectField(fieldName)">
							{{fieldConfig[fieldName].label}}</span>
					</div>
				</div></dd>
			</dl>
			<small translate="Custom Fields shown in <i>italics</i>"></small>
		</div>
		
		<!-- Right column: task view settings -->
		<div class="span9 control-group">
			
			<!-- settings -->
			<div class="well">
				<h3>{{fieldConfig[currentField.name].label}} {{'Field View Settings' | translate}}</h3>
				<div class="control-group">
					<div class="controls">
						<label class="checkbox {{interfaceConfig.pullNormal}}">
							<input type="checkbox" 
								data-ng-disabled="currentField.name == 'lexeme'" 
								data-ng-model="roleTab.view.fields[currentField.name].show"/>
							{{'Show field' | translate}}</label>
					</div>
					<br />
				</div>
				<div class="control-group">
					<div class="controls">
						<label class="checkbox {{interfaceConfig.pullNormal}}">
							<input type="checkbox" 
								data-ng-model="roleTab.view.fields[currentField.name].overrideInputSystems"/>
							{{'Override Input Systems' | translate}}</label>
						<br />
					</div>
				</div>
				<div data-ng-show="roleTab.view.fields[currentField.name].overrideInputSystems">
					<hr />
					<div class="row outer-flex control-group">
						<div class="span3 picklists">
							<label class="control-label" for="inputSystem">{{'Input Systems' | translate}}</label>
							<ul class="unstyled indent1"  id="inputSystem">
								<li data-ng-click="currentField.inputSystems.tag = inputSystemTag" 
									data-ng-repeat="inputSystemTag in currentField.inputSystems.fieldOrder" 
									data-ng-class="{selected:currentField.inputSystems.tag == inputSystemTag}">
									<div class="checkbox"><input data-ng-model="currentField.inputSystems.selecteds[inputSystemTag]" type="checkbox"/>
										{{configDirty.inputSystems[inputSystemTag].abbreviation}}</div>
								</li>
							</ul>
						</div>
						<div class="span1 btn-group btn-group-vertical">
							<button class="btn" data-ng-click="moveUp(currentField.inputSystems.tag)" 
								data-ng-disabled="currentField.inputSystems.fieldOrder[0] == currentField.inputSystems.tag || !currentField.inputSystems.tag">
								&nbsp;&nbsp;<i class="icon-arrow-up"></i></button>
							<button class="btn" data-ng-click="moveDown(currentField.inputSystems.tag)" 
								data-ng-disabled="currentField.inputSystems.fieldOrder[currentField.inputSystems.fieldOrder.length - 1] == currentField.inputSystems.tag || !currentField.inputSystems.tag">
								&nbsp;&nbsp;<i class="icon-arrow-down"></i></button>
						</div>
					</div>
				</div>
			</div>
		
		</div>
		
		</div>
		<div class="row outer-flex">
		
		<!-- Left column: field view settings -->
		<div class="span4 control-group">
			<h3 translate="Enabled Tasks"></h3>
			<dl>
				<dt translate="Dashboard"></dt>
				<dd><div class="controls">
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['dashboard']">
						{{'Dashboard' | translate}}</label>
				</div></dd>
				<dt translate="Dictionary"></dt>
				<dd><div class="controls">
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['dbe']">
						{{'Browse &amp; Edit' | translate}}</label>
				</div></dd>
				<dt translate="Add Information"></dt>
				<dd><div class="controls">
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['addMeanings']">
						{{'add Meanings' | translate}}</label>
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['addGrammar']">
						{{'add Grammatical Usage (Part of Speech)' | translate}}</label>
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['addExamples']">
						{{'add Examples' | translate}}</label>
				</div></dd>
				<dt translate="Gather Words"></dt>
				<dd><div class="controls">
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['gatherTexts']">
						{{'from Texts' | translate}}</label>
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['wordlist']">
						{{'from a Word List' | translate}}</label>
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['semdom']">
						{{'from Semantic Domains' | translate}}</label>
				</div></dd>
				<dt translate="Review"></dt>
				<dd><div class="controls">
					<label class="checkbox"><input type="checkbox" data-ng-model="roleTab.view.showTasks['review']">
						{{'Review' | translate}}</label>
				</div></dd>
			</dl>
		</div>
			
		</div>
	</tab>
	<tab heading="{{'Member Specific' | translate}}">
		<div data-ng-show="state === 'userList'">

			<!-- control buttons -->
			<form class="form-inline">
				<typeahead class="typeahead" items="add.users" term="add.typeahead.userName" search="add.queryProjectUsers" select="add.selectUser">
					<ul>
						<li typeahead-item="user" data-ng-repeat="user in add.users" class="typeahead-item">
							<img width="32px" data-ng-src="{{imageSource(user.avatarRef)}}" class="left">
							<p class="name">{{user.name}}</p>
							<p class="email">{{user.email}}</p>
						</li>
					</ul>
				</typeahead>
				<button class="btn btn-success" data-ng-disabled="add.disableAddButton" data-ng-click="addUser()"><i class="icon-plus"></i>{{'Add Member Specific Settings' | translate}}</button>
				<span class="warning" data-ng-show="add.warningText">{{add.warningText}}</span>
				<br /><br />
			</form>
		
			<div class="row outer-flex">
			
				<!-- Left column: user list -->
				<div class="span3">
					
					<!-- picklist -->
					<div class="control-group picklists">
						<ul class="unstyled">
							<li data-ng-click="selectUser(userId)" data-ng-repeat="(userId, userView) in configDirty.userViews" 
								data-ng-class="{selected:currentUserId == userId}"> 
								{{list.users[userId].name}} ({{list.users[userId].username}})</li>
						</ul>
					</div>
				</div>
				
			</div>
		</div>
		<div data-ng-show="state === 'userSettings'">
				<!-- control buttons -->
				<div class="control-group">
					<button class="btn" data-ng-click="state = 'userList'"><i class="icon-chevron-left"></i> {{'Back' | translate}}</button>
				</div>
		
		</div>
	</tab>
</tabset>
</form>
<!-- 
<pre>
currentField {{currentField | json}}
configDirty.roleTabs {{configDirty.roleTabs | json}}
</pre>
 -->
</div>
